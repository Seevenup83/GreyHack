// 7memory (scan libs remote and get Buffer overflow string)
ipAddress = "132.224.162.162"
//pAddress = params[0]
//port = params[1]
port = 22
newPass = "xxx"

metaxploit = include_lib("/lib/metaxploit.so")
if not metaxploit then exit("Error: Can't find metaxploit library in the /lib path or the current folder")

split1=function(s1)
  return s1.split("<b>")
end function

split2=function(s2)
  return s2.split("</b>")
end function

net_session = metaxploit.net_use(ipAddress, port)
metaLib = net_session.dump_lib
memoryZones = metaxploit.scan(metaLib)
for memoryZone in memoryZones
  unsafeChecks = metaxploit.scan_address(metaLib, memoryZone)
  for unsafeCheck in unsafeChecks.split("<b>")[1:unsafeChecks.len]
	bufferString = unsafeCheck.split("</b>")[0]
	result = metaLib.overflow(memoryZone, bufferString, newPass)
	if result then
	  print("<color=yellow>" + memoryZone + ":" + bufferString + "</color>")
	else
	  return false
	end if
  end for
end for
